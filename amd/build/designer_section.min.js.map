{"version":3,"sources":["../src/designer_section.js"],"names":["define","$","Fragment","Templates","Loadingicon","Ajax","Contact","SELECTOR","ACTIVITYLI","SECTIONLI","ACTIVITYACTION","SECTIONACTIONMENU","Y","use","courseformatselector","M","course","format","get_section_selector","DesignerSection","courseId","contextId","popupActivities","self","addClass","delegate","SectionController","sectionLayoutaction","bind","RestrictInfo","moduleHandler","sectionRestricted","sectionRestrictHandler","fullDescription","fullmodcontentHandler","trimDescription","trimmodcontentHandler","on","editModuleRenderer","goToURL","redirectToModule","window","onhashchange","expandSection","length","parents","sectionid","attr","section","document","getElementById","distance","offsetTop","body","scrollTop","setTimeout","scroll","removeClass","contactModal","getElementsByClassName","Array","from","forEach","element","addEventListener","e","preventDefault","currentTarget","dataset","userid","console","log","enhance","prototype","moduleBlock","loadingElement","moduleDescription","modules","addSectionSpinner","sectioninfo","sectionelement","actionarea","find","get","spinner","util","add_spinner","Node","show","event","nodeName","target","iscircle","closest","classList","contains","isDescription","isPadlock","ispopupModule","li","querySelector","click","card","modurl","getAttribute","location","href","sectionID","hash","id","substring","title","remove","setAttribute","content","add","scrollIntoView","removeSectionSpinner","delay","hide","getModuleId","Moodle","core_course","cm","getId","refreshSectionInfo","sectionId","sectionReturn","args","courseid","sectionreturn","promises","call","methodname","when","apply","done","dataencoded","data","parseJSON","i","replaceActivityhtml","type","keyCode","actionItem","moduleElement","action","moduleId","THIS","fullContent","trimcontent","hasClass","sectionRestrictInfo","prev","restrictBlock","iconBlock","layout","layouttext","text","html","val","parent","each","dataid","options","name","value","ULClasses","className","startsWith","cards","list","default","circles","addIconToContainerRemoveOnCompletion","activityHTML","replaceWith","initActionMenu","elementid","coursebase","invoke_function","core","actionmenu","newDOMNode","one","init"],"mappings":"AAsBCA,OAAM,oCAAC,CAAC,QAAD,CAAW,eAAX,CAA4B,gBAA5B,CAA8C,kBAA9C,CAAkE,WAAlE,CAA+E,oCAA/E,CAAD,CACN,SAASC,CAAT,CAAYC,CAAZ,CAAsBC,CAAtB,CAAiCC,CAAjC,CAA8CC,CAA9C,CAAoDC,CAApD,CAA6D,CAE1D,GAAIC,CAAAA,CAAQ,CAAG,CACXC,UAAU,CAAE,aADD,CAEXC,SAAS,CAAE,YAFA,CAGXC,cAAc,CAAE,kBAHL,CAIXC,iBAAiB,CAAE,oCAJR,CAAf,CAOAC,CAAC,CAACC,GAAF,CAAM,0BAAN,CAAkC,UAAW,CACzC,GAAIC,CAAAA,CAAoB,CAAGC,CAAC,CAACC,MAAF,CAASC,MAAT,CAAgBC,oBAAhB,EAA3B,CACA,GAAIJ,CAAJ,CAA0B,CACtBP,CAAQ,CAACE,SAAT,CAAqBK,CACxB,CACJ,CALD,EAaA,GAAIK,CAAAA,CAAe,CAAG,SAASC,CAAT,CAAmBC,CAAnB,CAA8BC,CAA9B,CAA+C,CACjE,GAAIC,CAAAA,CAAI,CAAG,IAAX,CACAA,CAAI,CAACH,QAAL,CAAgBA,CAAhB,CACAG,CAAI,CAACF,SAAL,CAAiBA,CAAjB,CACAE,CAAI,CAACD,eAAL,CAAuBA,CAAvB,CAEArB,CAAC,CAAC,0DAAD,CAAD,CAA8DuB,QAA9D,CAAuE,QAAvE,EACAvB,CAAC,CAAC,sDAAD,CAAD,CAA0DuB,QAA1D,CAAmE,QAAnE,EAEAvB,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACG,iBAAxB,CAA2C,OAA3C,CAAoDH,CAAI,CAACI,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAApD,EACA3B,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACM,YAAxB,CAAsC,OAAtC,CAA+CN,CAAI,CAACO,aAAL,CAAmBF,IAAnB,CAAwB,IAAxB,CAA/C,EACA3B,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACQ,iBAAxB,CAA2C,OAA3C,CAAoD,KAAKC,sBAAL,CAA4BJ,IAA5B,CAAiC,IAAjC,CAApD,EACA3B,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACU,eAAxB,CAAyC,OAAzC,CAAkDV,CAAI,CAACW,qBAAL,CAA2BN,IAA3B,CAAgC,IAAhC,CAAlD,EACA3B,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACY,eAAxB,CAAyC,OAAzC,CAAkDZ,CAAI,CAACa,qBAAL,CAA2BR,IAA3B,CAAgC,IAAhC,CAAlD,EACA3B,CAAC,CAAC,MAAD,CAAD,CAAUoC,EAAV,CAAa,gBAAb,CAA+B9B,CAAQ,CAACC,UAAT,CAAsB,GAAtB,CAC/BD,CAAQ,CAACG,cADsB,CACL,eAD1B,CAC2C,KAAK4B,kBAAL,CAAwBV,IAAxB,CAA6B,IAA7B,CAD3C,EAEA3B,CAAC,CAAC,MAAD,CAAD,CAAUwB,QAAV,CAAmBF,CAAI,CAACgB,OAAxB,CAAiC,OAAjC,CAA0ChB,CAAI,CAACiB,gBAAL,CAAsBZ,IAAtB,CAA2B,IAA3B,CAA1C,EACAa,MAAM,CAACC,YAAP,CAAsB,UAAW,CAC7BnB,CAAI,CAACoB,aAAL,EACH,CAFD,CAGA,KAAKA,aAAL,GACA,GAAoC,CAAhC,CAAA1C,CAAC,CAAC,mBAAD,CAAD,CAAuB2C,MAA3B,CAAuC,CACnC3C,CAAC,CAAC,WAAD,CAAD,CAAeoC,EAAf,CAAkB,kBAAlB,CAAsC,UAAW,CAC7CpC,CAAC,CAAC,IAAD,CAAD,CAAQ4C,OAAR,CAAgB,YAAhB,EAA8BrB,QAA9B,CAAuC,yBAAvC,EAD6C,GAEzCsB,CAAAA,CAAS,CAAG7C,CAAC,CAAC,IAAD,CAAD,CAAQ4C,OAAR,CAAgB,YAAhB,EAA8BE,IAA9B,CAAmC,IAAnC,CAF6B,CAGzCC,CAAO,CAAGC,QAAQ,CAACC,cAAT,CAAwBJ,CAAxB,CAH+B,CAIzCK,CAAQ,CAAGH,CAAO,CAACI,SAAR,CAAoBH,QAAQ,CAACI,IAAT,CAAcC,SAJJ,CAK7CC,UAAU,CAAC,iBAAMd,CAAAA,MAAM,CAACe,MAAP,CAAc,CAAd,CAAiBL,CAAjB,CAAN,CAAD,CAAmC,EAAnC,CACb,CAND,EAMGd,EANH,CAMM,mBANN,CAM2B,UAAW,CAClCpC,CAAC,CAAC,IAAD,CAAD,CAAQ4C,OAAR,CAAgB,YAAhB,EAA8BY,WAA9B,CAA0C,yBAA1C,CACH,CARD,CASH,CACD,GAAIC,CAAAA,CAAY,CAAGT,QAAQ,CAACU,sBAAT,CAAgC,uBAAhC,CAAnB,CACAC,KAAK,CAACC,IAAN,CAAWH,CAAX,EAAyBI,OAAzB,CAAiC,SAASC,CAAT,CAAkB,CAC/CA,CAAO,CAACC,gBAAR,CAAyB,OAAzB,CAAkC,SAASC,CAAT,CAAY,CAC1CA,CAAC,CAACC,cAAF,GACA,GAAID,CAAC,CAACE,aAAF,CAAgBC,OAAhB,CAAwBC,MAAxB,QAAJ,CAAiD,CAC7CC,OAAO,CAACC,GAAR,CAAYN,CAAC,CAACE,aAAF,CAAgBC,OAAhB,CAAwBC,MAApC,EACA/D,CAAO,CAACkE,OAAR,CAAgBP,CAAC,CAACE,aAAlB,CACH,CACJ,CAND,CAOH,CARD,CASH,CA1CD,CA+CAhD,CAAe,CAACsD,SAAhB,CAA0BlC,OAA1B,CAAoC,uCAApC,CAEApB,CAAe,CAACsD,SAAhB,CAA0B/C,iBAA1B,CAA8C,qDAA9C,CAEAP,CAAe,CAACsD,SAAhB,CAA0B5C,YAA1B,CAAyC,wDAAzC,CAEAV,CAAe,CAACsD,SAAhB,CAA0BC,WAA1B,CAAwC,iDAAxC,CAEAvD,CAAe,CAACsD,SAAhB,CAA0BE,cAA1B,CAA2C,oBAA3C,CAEAxD,CAAe,CAACsD,SAAhB,CAA0B1C,iBAA1B,CAA8C,kEAA9C,CAEAZ,CAAe,CAACsD,SAAhB,CAA0BG,iBAA1B,CAA8C,gEAA9C,CAEAzD,CAAe,CAACsD,SAAhB,CAA0BxC,eAA1B,CAA4C,2EAA5C,CAEAd,CAAe,CAACsD,SAAhB,CAA0BtC,eAA1B,CAA4C,oEAA5C,CAEAhB,CAAe,CAACsD,SAAhB,CAA0BI,OAA1B,CAAoC,IAApC,CAEA1D,CAAe,CAACsD,SAAhB,CAA0BK,iBAA1B,CAA8C,SAASC,CAAT,CAAsB,IAC5DC,CAAAA,CAAc,CAAG/E,CAAC,CAAC8E,CAAD,CAAD,CAAevD,QAAf,CAAwB,gBAAxB,CAD2C,CAE5DyD,CAAU,CAAGD,CAAc,CAACE,IAAf,CAAoB,YAApB,EAAkCC,GAAlC,CAAsC,CAAtC,CAF+C,CAGhE,GAAIF,CAAJ,CAAgB,CACZ,GAAIG,CAAAA,CAAO,CAAGrE,CAAC,CAACsE,IAAF,CAAOC,WAAP,CAAmB1E,CAAnB,CAAsBA,CAAC,CAAC2E,IAAF,CAAON,CAAP,CAAtB,CAAd,CACAG,CAAO,CAACI,IAAR,GACA,MAAOJ,CAAAA,CACV,CACD,MAAO,KACV,CATD,CAYAjE,CAAe,CAACsD,SAAhB,CAA0BjC,gBAA1B,CAA6C,SAASiD,CAAT,CAAgB,IACrDC,CAAAA,CAAQ,CAAGD,CAAK,CAACE,MAAN,CAAaD,QAD6B,CAGrDE,CAAQ,CAAGH,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,aAArB,EAAoCC,SAApC,CAA8CC,QAA9C,CAAuD,eAAvD,CAH0C,CAIrDC,CAAa,CAAGP,CAAK,CAACE,MAAN,CAAaG,SAAb,CAAuBC,QAAvB,CAAgC,wBAAhC,CAJqC,CAKrDE,CAAS,CAAGR,CAAK,CAACE,MAAN,CAAaG,SAAb,CAAuBC,QAAvB,CAAgC,SAAhC,CALyC,CAMrDG,CAAa,CAAGT,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,aAArB,EAAoCC,SAApC,CAA8CC,QAA9C,CAAuD,WAAvD,CANqC,CAOzD,GAAKL,CAAQ,GALS,CAAC,GAAD,CAAM,QAAN,CAAgB,MAAhB,CAKlB,EACGzC,QAAQ,CAACI,IAAT,CAAcyC,SAAd,CAAwBC,QAAxB,CAAiC,SAAjC,CADH,EACkDH,CADlD,EAC8DI,CAD9D,EAC+EC,CAD/E,EAC4FC,CADhG,CAC+G,CAC3G,GAAIA,CAAa,EAAI,CAACjD,QAAQ,CAACI,IAAT,CAAcyC,SAAd,CAAwBC,QAAxB,CAAiC,SAAjC,CAAtB,CAAmE,CAC/D,GAAII,CAAAA,CAAE,CAAGV,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,aAArB,CAAT,CACAM,CAAE,CAACC,aAAH,CAAiB,SAAjB,EAA4BC,KAA5B,EAEH,CACD,MAAO,KACV,CAfwD,GAgBrDC,CAAAA,CAAI,CAAGb,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,yBAArB,CAhB8C,CAiBrDU,CAAM,CAAGD,CAAI,CAACE,YAAL,CAAkB,UAAlB,CAjB4C,CAkBzD/D,MAAM,CAACgE,QAAP,CAAgBC,IAAhB,CAAuBH,CAAvB,CACA,QACH,CApBD,CAsBApF,CAAe,CAACsD,SAAhB,CAA0B9B,aAA1B,CAA0C,UAAM,CAE5C,GAAIgE,CAAAA,CAAS,CAAGlE,MAAM,CAACgE,QAAP,CAAgBG,IAAhC,CACA,GAAID,CAAJ,CAAe,IACPE,CAAAA,CAAE,CAAGF,CAAS,CAACG,SAAV,CAAoB,CAApB,CADE,CAEP9D,CAAO,CAAGC,QAAQ,CAACC,cAAT,CAAwB2D,CAAxB,CAFH,CAGX,GAAI7D,CAAJ,CAAa,CACT,GAAI+D,CAAAA,CAAK,CAAG/D,CAAO,CAACoD,aAAR,CAAsB,yBAAtB,CAAZ,CACA,GAAIW,CAAJ,CAAW,CACPA,CAAK,CAACjB,SAAN,CAAgBkB,MAAhB,CAAuB,WAAvB,EACAD,CAAK,CAACE,YAAN,CAAmB,eAAnB,IACH,CACD,GAAIC,CAAAA,CAAO,CAAGlE,CAAO,CAACoD,aAAR,CAAsB,UAAtB,CAAd,CACA,GAAIc,CAAJ,CAAa,CACTA,CAAO,CAACpB,SAAR,CAAkBqB,GAAlB,CAAsB,MAAtB,CACH,CACD,GAA4D,IAAxD,GAAAlE,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,CAAJ,CAAkE,CAC9DD,QAAQ,CAACC,cAAT,CAAwB,gBAAxB,EAA0C4C,SAA1C,CAAoDqB,GAApD,CAAwD,WAAxD,EACAlE,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,EAA6C4C,SAA7C,CAAuDkB,MAAvD,CAA8D,MAA9D,CACH,CACDhE,CAAO,CAACoE,cAAR,EACH,CACJ,CACJ,CAvBD,CAyBAjG,CAAe,CAACsD,SAAhB,CAA0B4C,oBAA1B,CAAiD,SAAStC,CAAT,CAAsBK,CAAtB,CAA+BkC,CAA/B,CAAsC,CACnF,GAAIvD,CAAAA,CAAO,CAAG9D,CAAC,CAAC8E,CAAD,CAAf,CACAtC,MAAM,CAACc,UAAP,CAAkB,UAAW,CACzBQ,CAAO,CAACN,WAAR,CAAoB,gBAApB,EACA,GAAI2B,CAAJ,CAAa,CACTA,CAAO,CAACmC,IAAR,EACH,CACJ,CALD,CAKGD,CALH,CAMH,CARD,CAgBCnG,CAAe,CAACsD,SAAhB,CAA0B+C,WAA1B,CAAwC,SAASzD,CAAT,CAAkB,CACvD,GAAI8C,CAAAA,CAAJ,CACAjG,CAAC,CAACC,GAAF,CAAM,oBAAN,CAA4B,SAASD,CAAT,CAAY,CACpCiG,CAAE,CAAGjG,CAAC,CAAC6G,MAAF,CAASC,WAAT,CAAqBrC,IAArB,CAA0BsC,EAA1B,CAA6BC,KAA7B,CAAmChH,CAAC,CAAC2E,IAAF,CAAOxB,CAAO,CAACoB,GAAR,CAAY,CAAZ,CAAP,CAAnC,CACR,CAFD,EAGA,MAAO0B,CAAAA,CACV,CANA,CAQD1F,CAAe,CAACsD,SAAhB,CAA0BoD,kBAA1B,CAA+C,SAASlC,CAAT,CAAiB,IACxDpE,CAAAA,CAAI,CAAG,IADiD,CAExDwD,CAAW,CAAGY,CAAM,CAACxB,aAAP,CAAqB0B,OAArB,CAA6B,YAA7B,CAF0C,CAGxDiC,CAAS,CAAG7H,CAAC,CAAC8E,CAAD,CAAD,CAAehC,IAAf,CAAoB,SAApB,CAH4C,CAIxDgF,CAAa,CAAG9H,CAAC,CAAC8E,CAAD,CAAD,CAAehC,IAAf,CAAoB,sBAApB,CAJwC,CAKxDqC,CAAO,CAAG7D,CAAI,CAACuD,iBAAL,CAAuBC,CAAvB,CAL8C,CAMxDiD,CAAI,CAAG,CACPC,QAAQ,CAAE1G,CAAI,CAACH,QADR,CAEP0B,SAAS,CAAEgF,CAFJ,CAGPI,aAAa,CAAEH,CAHR,CANiD,CAW5DtF,MAAM,CAACc,UAAP,CAAkB,SAASyE,CAAT,CAAe,CAC7B,GAAIG,CAAAA,CAAQ,CAAG9H,CAAI,CAAC+H,IAAL,CAAU,CAAC,CACtBC,UAAU,CAAE,iCADU,CAEtBL,IAAI,CAAEA,CAFgB,CAAD,CAAV,IAAf,CAIA/H,CAAC,CAACqI,IAAF,CAAOC,KAAP,CAAatI,CAAb,CAAgBkI,CAAhB,EACKK,IADL,CACU,SAASC,CAAT,CAAsB,CACxB,GAAIC,CAAAA,CAAI,CAAGzI,CAAC,CAAC0I,SAAF,CAAYF,CAAZ,CAAX,CACA,GAAIC,CAAI,CAAC7D,OAAL,SAAJ,CAAgC,CAC5B,IAAK,GAAI+D,CAAAA,CAAT,GAAcF,CAAAA,CAAI,CAAC7D,OAAnB,CAA4B,CACxBtD,CAAI,CAACsH,mBAAL,CAAyBH,CAAI,CAAC7D,OAAL,CAAa+D,CAAb,CAAzB,CACH,CACJ,CACJ,CARL,CAUH,CAfD,CAeG,GAfH,CAeSZ,CAfT,EAgBAzG,CAAI,CAAC8F,oBAAL,CAA0BtC,CAA1B,CAAuCK,CAAvC,CAAgD,GAAhD,CACH,CA5BD,CA8BAjE,CAAe,CAACsD,SAAhB,CAA0BnC,kBAA1B,CAA+C,SAASmD,CAAT,CAAgB,CAC3D,GAAIlE,CAAAA,CAAI,CAAG,IAAX,CACA,GAAmB,UAAf,GAAAkE,CAAK,CAACqD,IAAN,EAA+C,EAAlB,GAAArD,CAAK,CAACsD,OAAvC,CAAuD,CACnD,MACH,CACD,GAAIC,CAAAA,CAAU,CAAG/I,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAlB,CACA8E,CAAa,CAAGD,CAAU,CAACnD,OAAX,CAAmBtF,CAAQ,CAACC,UAA5B,CADhB,CAEA0I,CAAM,CAAGF,CAAU,CAACjG,IAAX,CAAgB,aAAhB,CAFT,CAGAoG,CAAQ,CAAG5H,CAAI,CAACiG,WAAL,CAAiByB,CAAjB,CAHX,CAIA,OAAQC,CAAR,EACI,IAAK,UAAL,CACA,IAAK,WAAL,CACA,IAAK,QAAL,CACA,IAAK,WAAL,CACA,IAAK,MAAL,CACA,IAAK,SAAL,CACA,IAAK,MAAL,CACA,IAAK,gBAAL,CACA,IAAK,eAAL,CACA,IAAK,YAAL,CACI,MACJ,QAEI,OAdR,CAgBA,GAAI,CAACC,CAAL,CAAe,CACX,MACH,CACD1D,CAAK,CAACvB,cAAN,GACA,GAAe,QAAX,GAAAgF,CAAJ,CAAyB,CAErBzG,MAAM,CAACc,UAAP,CAAkB,UAAW,CACzBtD,CAAC,CAAC,4CAAD,CAAD,CAA8CoG,KAA9C,CAAoD,UAAW,CAC3D9E,CAAI,CAACsG,kBAAL,CAAwBpC,CAAxB,CACH,CAFD,CAGH,CAJD,CAIG,GAJH,CAKH,CAPD,IAOO,CACHlE,CAAI,CAACsG,kBAAL,CAAwBpC,CAAxB,CACH,CACJ,CAvCD,CAyCAtE,CAAe,CAACsD,SAAhB,CAA0BvC,qBAA1B,CAAkD,SAASuD,CAAT,CAAgB,IAC1D2D,CAAAA,CAAI,CAAGnJ,CAAC,CAACwF,CAAK,CAACtB,aAAP,CADkD,CAE1DkF,CAAW,CAAGpJ,CAAC,CAACmJ,CAAD,CAAD,CAAQvD,OAAR,CAAgB,aAAhB,EAA+BX,IAA/B,CAAoC,sBAApC,CAF4C,CAG1DoE,CAAW,CAAGrJ,CAAC,CAACmJ,CAAD,CAAD,CAAQvD,OAAR,CAAgB,aAAhB,EAA+BX,IAA/B,CAAoC,eAApC,CAH4C,CAI9D,GAAIoE,CAAW,CAACC,QAAZ,CAAqB,cAArB,CAAJ,CAA0C,CACtCD,CAAW,CAAC7F,WAAZ,CAAwB,cAAxB,EACA4F,CAAW,CAAC7H,QAAZ,CAAqB,cAArB,CACH,CACJ,CARD,CAUAL,CAAe,CAACsD,SAAhB,CAA0BrC,qBAA1B,CAAkD,SAASqD,CAAT,CAAgB,IAC1D2D,CAAAA,CAAI,CAAGnJ,CAAC,CAACwF,CAAK,CAACtB,aAAP,CADkD,CAE1DkF,CAAW,CAAGpJ,CAAC,CAACmJ,CAAD,CAAD,CAAQvD,OAAR,CAAgB,aAAhB,EAA+BX,IAA/B,CAAoC,sBAApC,CAF4C,CAG1DoE,CAAW,CAAGrJ,CAAC,CAACmJ,CAAD,CAAD,CAAQvD,OAAR,CAAgB,aAAhB,EAA+BX,IAA/B,CAAoC,eAApC,CAH4C,CAI9D,GAAImE,CAAW,CAACE,QAAZ,CAAqB,cAArB,CAAJ,CAA0C,CACtCF,CAAW,CAAC5F,WAAZ,CAAwB,cAAxB,EACA6F,CAAW,CAAC9H,QAAZ,CAAqB,cAArB,CACH,CACJ,CARD,CAUAL,CAAe,CAACsD,SAAhB,CAA0BzC,sBAA1B,CAAmD,SAASyD,CAAT,CAAgB,CAC/D,GAAI+D,CAAAA,CAAmB,CAAGvJ,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAD,CAAuBsF,IAAvB,EAA1B,CACA,GAAID,CAAJ,CAAyB,CACrB,GAAI,CAACA,CAAmB,CAACD,QAApB,CAA6B,MAA7B,CAAL,CAA2C,CACvCC,CAAmB,CAAChI,QAApB,CAA6B,MAA7B,CACH,CAFD,IAEO,CACHgI,CAAmB,CAAC/F,WAApB,CAAgC,MAAhC,CACH,CACJ,CACJ,CATD,CAWAtC,CAAe,CAACsD,SAAhB,CAA0B3C,aAA1B,CAA0C,SAAS2D,CAAT,CAAgB,CACtDA,CAAK,CAACvB,cAAN,GACA,GAAIwF,CAAAA,CAAa,CAAGzJ,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAD,CAAuBtB,OAAvB,CAA+B,iBAA/B,CAApB,CACA,GAAI6G,CAAa,CAAC9G,MAAlB,CAA0B,CACtB,GAAI,CAAC8G,CAAa,CAACH,QAAd,CAAuB,MAAvB,CAAL,CAAqC,CACjCG,CAAa,CAAClI,QAAd,CAAuB,MAAvB,CACH,CAFD,IAEO,CACHkI,CAAa,CAACjG,WAAd,CAA0B,MAA1B,CACH,CACJ,CACJ,CAVD,CAgBAtC,CAAe,CAACsD,SAAhB,CAA0B9C,mBAA1B,CAAgD,SAAS8D,CAAT,CAAgB,IACxDlE,CAAAA,CAAI,CAAG,IADiD,CAExDuG,CAAS,CAAGrC,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,YAArB,EAAmCW,YAAnC,CAAgD,IAAhD,CAF4C,CAGxDmD,CAAS,CAAG,IAAM7B,CAAN,CAAkB,GAAlB,CAAwBvG,CAAI,CAACoD,cAHe,CAIxDiF,CAAM,CAAG3J,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAD,CAAuBuE,IAAvB,CAA4B,OAA5B,CAJ+C,CAKxDmB,CAAU,CAAG5J,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAD,CAAuB2F,IAAvB,EAL2C,CAM5D7J,CAAC,CAACwF,CAAK,CAACE,MAAP,CAAD,CAAgB9C,OAAhB,CAAwB,WAAxB,EAAqCqC,IAArC,CAA0C,MAA1C,EAAkD6E,IAAlD,CAAuDF,CAAvD,EACA5J,CAAC,CAACwF,CAAK,CAACE,MAAP,CAAD,CAAgB9C,OAAhB,CAAwB,WAAxB,EAAqCqC,IAArC,CAA0C,MAA1C,EAAkD8E,GAAlD,CAAsDJ,CAAtD,EACA3J,CAAC,CAACwF,CAAK,CAACE,MAAP,CAAD,CAAgBsE,MAAhB,GAAyB/E,IAAzB,CAA8B,iBAA9B,EAAiDgF,IAAjD,CAAsD,UAAW,CAC7DjK,CAAC,CAAC,IAAD,CAAD,CAAQwD,WAAR,CAAoB,QAApB,CACH,CAFD,EAGAxD,CAAC,CAACwF,CAAK,CAACE,MAAP,CAAD,CAAgBnE,QAAhB,CAAyB,QAAzB,EAX4D,GAYxD2I,CAAAA,CAAM,CAAG1E,CAAK,CAACE,MAAN,CAAaE,OAAb,CAAqB,YAArB,EAAmCW,YAAnC,CAAgD,SAAhD,CAZ+C,CAaxDwB,CAAI,CAAG,CACPC,QAAQ,CAAE1G,CAAI,CAACH,QADR,CAEP0B,SAAS,CAAEqH,CAFJ,CAGPC,OAAO,CAAE,CAAC,CAACC,IAAI,CAAEpK,CAAC,CAACwF,CAAK,CAACtB,aAAP,CAAD,CAAuBuE,IAAvB,CAA4B,QAA5B,CAAP,CAA8C4B,KAAK,CAAEV,CAArD,CAAD,CAHF,CAbiD,CAkBxDW,CAAS,CAAG,CACZ,MAAS,uBADG,CAEZ,KAAQ,aAFI,CAGZ,QAAW,aAHC,CAIZ,QAAW,gBAJC,CAKZ,mBAAsB,0CALV,CAlB4C,CA0BxDpC,CAAQ,CAAG9H,CAAI,CAAC+H,IAAL,CAAU,CAAC,CAClBC,UAAU,CAAE,qCADM,CAElBL,IAAI,CAAEA,CAFY,CAAD,CAAV,IA1B6C,CA8B5D/H,CAAC,CAACqI,IAAF,CAAOC,KAAP,CAAatI,CAAb,CAAgBkI,CAAhB,EACKK,IADL,CACU,SAASC,CAAT,CAAsB,CACxB,GAAIC,CAAAA,CAAI,CAAGzI,CAAC,CAAC0I,SAAF,CAAYF,CAAZ,CAAX,CACA,GAAIC,CAAI,CAAC7D,OAAL,SAAJ,CAAgC,CAC5B,IAAK,GAAI+D,CAAAA,CAAT,GAAcF,CAAAA,CAAI,CAAC7D,OAAnB,CAA4B,CACxBtD,CAAI,CAACsH,mBAAL,CAAyBH,CAAI,CAAC7D,OAAL,CAAa+D,CAAb,CAAzB,CACH,CACD3F,QAAQ,CAACC,cAAT,CAAwB4E,CAAxB,EAAmChC,SAAnC,CAA6ChC,OAA7C,CAAqD,SAAC0G,CAAD,CAAe,CAChE,GAAIA,CAAS,CAACC,UAAV,CAAqB,eAArB,CAAJ,CAA2C,CACvCxH,QAAQ,CAACC,cAAT,CAAwB4E,CAAxB,EAAmChC,SAAnC,CAA6CkB,MAA7C,CAAoDwD,CAApD,CACH,CACJ,CAJD,EAKAvH,QAAQ,CAACC,cAAT,CAAwB4E,CAAxB,EAAmChC,SAAnC,CAA6CqB,GAA7C,CAAiD,gBAAkByC,CAAnE,EACA3J,CAAC,CAAC,IAAM6H,CAAP,CAAD,CAAmB5C,IAAnB,CAAwB,YAAxB,EAAsCzB,WAAtC,CAAkD8G,CAAS,CAACG,KAA5D,EACAzK,CAAC,CAAC,IAAM6H,CAAP,CAAD,CAAmB5C,IAAnB,CAAwB,YAAxB,EAAsCzB,WAAtC,CAAkD8G,CAAS,CAACI,IAA5D,EACA1K,CAAC,CAAC,IAAM6H,CAAP,CAAD,CAAmB5C,IAAnB,CAAwB,YAAxB,EAAsCzB,WAAtC,CAAkD8G,CAAS,CAACK,OAA5D,EACA3K,CAAC,CAAC,IAAM6H,CAAP,CAAD,CAAmB5C,IAAnB,CAAwB,YAAxB,EAAsCzB,WAAtC,CAAkD8G,CAAS,CAACM,OAA5D,EACA5K,CAAC,CAAC,IAAM6H,CAAP,CAAD,CAAmB5C,IAAnB,CAAwB,YAAxB,EAAsC1D,QAAtC,CAA+C+I,CAAS,CAACX,CAAD,CAAxD,CACH,CACJ,CAnBL,EAoBAxJ,CAAW,CAAC0K,oCAAZ,CAAiDnB,CAAjD,CAA4DxB,CAA5D,CACH,CAnDD,CA0DAhH,CAAe,CAACsD,SAAhB,CAA0BoE,mBAA1B,CAAgD,SAASkC,CAAT,CAAuB,CACnE9K,CAAC,CAAC,QAAU8K,CAAV,CAAyB,QAA1B,CAAD,CAAqC7F,IAArC,CAA0C3E,CAAQ,CAACC,UAAnD,EAA+D0J,IAA/D,CAAoE,UAAW,CAE3E,GAAIrD,CAAAA,CAAE,CAAG5G,CAAC,CAAC,IAAD,CAAD,CAAQ8C,IAAR,CAAa,IAAb,CAAT,CAEA9C,CAAC,CAACM,CAAQ,CAACC,UAAT,CAAsB,GAAtB,CAA4BqG,CAA7B,CAAD,CAAkCmE,WAAlC,CAA8CD,CAA9C,EAEAE,CAAc,CAACpE,CAAD,CACjB,CAPD,CAQH,CATD,CAgBA,GAAIoE,CAAAA,CAAc,CAAG,SAASC,CAAT,CAAoB,CAErCtK,CAAC,CAACC,GAAF,CAAM,0BAAN,CAAkC,UAAW,CACzCE,CAAC,CAACC,MAAF,CAASmK,UAAT,CAAoBC,eAApB,CAAoC,oBAApC,CAA0D,IAAMF,CAAhE,CACH,CAFD,EAGA,GAAInK,CAAC,CAACsK,IAAF,CAAOC,UAAP,EAAqBvK,CAAC,CAACsK,IAAF,CAAOC,UAAP,CAAkBC,UAA3C,CAAuD,CACnDxK,CAAC,CAACsK,IAAF,CAAOC,UAAP,CAAkBC,UAAlB,CAA6B3K,CAAC,CAAC4K,GAAF,CAAM,IAAMN,CAAZ,CAA7B,CACH,CACJ,CARD,CAUA,MAAO,CACHO,IAAI,CAAE,cAASrK,CAAT,CAAmBC,CAAnB,CAA8BC,CAA9B,CAA+C,CACjD,MAAO,IAAIH,CAAAA,CAAJ,CAAoBC,CAApB,CAA8BC,CAA9B,CAAyCC,CAAzC,CACV,CAHE,CAKV,CA5XM,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Implemented designer format js.\r\n *\r\n * @module     format_designer/designer_section\r\n * @copyright  2021 bdecent gmbh <https://bdecent.de>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n define(['jquery', 'core/fragment', 'core/templates', 'core/loadingicon', 'core/ajax', 'core_message/toggle_contact_button'],\r\n function($, Fragment, Templates, Loadingicon, Ajax, Contact) {\r\n\r\n    var SELECTOR = {\r\n        ACTIVITYLI: 'li.activity',\r\n        SECTIONLI: 'li.section',\r\n        ACTIVITYACTION: 'a.cm-edit-action',\r\n        SECTIONACTIONMENU: '.section_action_menu.designer-menu',\r\n    };\r\n\r\n    Y.use('moodle-course-coursebase', function() {\r\n        var courseformatselector = M.course.format.get_section_selector();\r\n        if (courseformatselector) {\r\n            SELECTOR.SECTIONLI = courseformatselector;\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Control designer format action\r\n     * @param {int} courseId\r\n     * @param {int} contextId\r\n     * @param {bool} popupActivities\r\n     */\r\n    let DesignerSection = function(courseId, contextId, popupActivities) {\r\n        var self = this;\r\n        self.courseId = courseId;\r\n        self.contextId = contextId;\r\n        self.popupActivities = popupActivities;\r\n\r\n        $(\".course-info-block .carousel .carousel-item:nth-child(1)\").addClass('active');\r\n        $(\".course-info-block #courseStaffinfoControls.carousel\").addClass('active');\r\n\r\n        $('body').delegate(self.SectionController, 'click', self.sectionLayoutaction.bind(this));\r\n        $(\"body\").delegate(self.RestrictInfo, \"click\", self.moduleHandler.bind(this));\r\n        $(\"body\").delegate(self.sectionRestricted, \"click\", this.sectionRestrictHandler.bind(this));\r\n        $('body').delegate(self.fullDescription, \"click\", self.fullmodcontentHandler.bind(this));\r\n        $('body').delegate(self.trimDescription, \"click\", self.trimmodcontentHandler.bind(this));\r\n        $('body').on('click keypress', SELECTOR.ACTIVITYLI + ' ' +\r\n        SELECTOR.ACTIVITYACTION + '[data-action]', this.editModuleRenderer.bind(this));\r\n        $('body').delegate(self.goToURL, \"click\", self.redirectToModule.bind(this));\r\n        window.onhashchange = function() {\r\n            self.expandSection();\r\n        };\r\n        this.expandSection();\r\n        if ($('.course-type-flow').length > 0) {\r\n            $('.collapse').on('show.bs.collapse', function() {\r\n                $(this).parents('li.section').addClass('stack-header-collapsing');\r\n                var sectionid = $(this).parents('li.section').attr('id');\r\n                var section = document.getElementById(sectionid);\r\n                var distance = section.offsetTop - document.body.scrollTop;\r\n                setTimeout(() => window.scroll(0, distance), 50);\r\n            }).on('shown.bs.collapse', function() {\r\n                $(this).parents('li.section').removeClass('stack-header-collapsing');\r\n            });\r\n        }\r\n        var contactModal = document.getElementsByClassName('toggle-contact-button');\r\n        Array.from(contactModal).forEach(function(element) {\r\n            element.addEventListener('click', function(e) {\r\n                e.preventDefault();\r\n                if (e.currentTarget.dataset.userid != undefined) {\r\n                    console.log(e.currentTarget.dataset.userid);\r\n                    Contact.enhance(e.currentTarget);\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Selector section controller.\r\n     */\r\n    DesignerSection.prototype.goToURL = '.designer [data-action=\"go-to-url\"]';\r\n\r\n    DesignerSection.prototype.SectionController = \".designer #section-designer-action .dropdown-menu a\";\r\n\r\n    DesignerSection.prototype.RestrictInfo = \".designer .designer-section-content .call-action-block\";\r\n\r\n    DesignerSection.prototype.moduleBlock = \".designer .designer-section-content li.activity\";\r\n\r\n    DesignerSection.prototype.loadingElement = \".icon-loader-block\";\r\n\r\n    DesignerSection.prototype.sectionRestricted = \".designer .availability-section-block .section-restricted-action\";\r\n\r\n    DesignerSection.prototype.moduleDescription = \".designer .designer-section-content li .mod-description-action\";\r\n\r\n    DesignerSection.prototype.fullDescription = \".designer-section-content li .fullcontent-summary .mod-description-action\";\r\n\r\n    DesignerSection.prototype.trimDescription = \".designer-section-content li .trim-summary .mod-description-action\";\r\n\r\n    DesignerSection.prototype.modules = null;\r\n\r\n    DesignerSection.prototype.addSectionSpinner = function(sectioninfo) {\r\n        var sectionelement = $(sectioninfo).addClass('editinprogress');\r\n        var actionarea = sectionelement.find('li.section').get(0);\r\n        if (actionarea) {\r\n            var spinner = M.util.add_spinner(Y, Y.Node(actionarea));\r\n            spinner.show();\r\n            return spinner;\r\n        }\r\n        return null;\r\n    };\r\n\r\n\r\n    DesignerSection.prototype.redirectToModule = function(event) {\r\n        let nodeName = event.target.nodeName;\r\n        let preventionNodes = ['a', 'button', 'form'];\r\n        let iscircle = event.target.closest('li.activity').classList.contains('circle-layout');\r\n        let isDescription = event.target.classList.contains('mod-description-action');\r\n        let isPadlock = event.target.classList.contains('fa-lock');\r\n        let ispopupModule = event.target.closest('li.activity').classList.contains('popmodule');\r\n        if ((nodeName in preventionNodes)\r\n            || document.body.classList.contains('editing') || iscircle || isDescription || isPadlock || ispopupModule) {\r\n            if (ispopupModule && !document.body.classList.contains('editing')) {\r\n                var li = event.target.closest('li.activity');\r\n                li.querySelector('a[href]').click();\r\n                // Event.target.closest('a').click();\r\n            }\r\n            return null;\r\n        }\r\n        var card = event.target.closest(\"[data-action=go-to-url]\");\r\n        let modurl = card.getAttribute('data-url');\r\n        window.location.href = modurl;\r\n        return true;\r\n    };\r\n\r\n    DesignerSection.prototype.expandSection = () => {\r\n        // Alert();\r\n        var sectionID = window.location.hash;\r\n        if (sectionID) {\r\n            var id = sectionID.substring(1);\r\n            var section = document.getElementById(id);\r\n            if (section) {\r\n                var title = section.querySelector('.section-header-content');\r\n                if (title) {\r\n                    title.classList.remove('collapsed');\r\n                    title.setAttribute('aria-expanded', true);\r\n                }\r\n                var content = section.querySelector('.content');\r\n                if (content) {\r\n                    content.classList.add('show');\r\n                }\r\n                if (document.getElementById('section-course-accordion') !== null) {\r\n                    document.getElementById('section-head-0').classList.add('collapsed');\r\n                    document.getElementById('section-content-0').classList.remove('show');\r\n                }\r\n                section.scrollIntoView();\r\n            }\r\n        }\r\n    };\r\n\r\n    DesignerSection.prototype.removeSectionSpinner = function(sectioninfo, spinner, delay) {\r\n        var element = $(sectioninfo);\r\n        window.setTimeout(function() {\r\n            element.removeClass('editinprogress');\r\n            if (spinner) {\r\n                spinner.hide();\r\n            }\r\n        }, delay);\r\n    };\r\n\r\n    /**\r\n     * Wrapper for Y.Moodle.core_course.util.cm.getId\r\n     *\r\n     * @param {JQuery} element\r\n     * @returns {Integer}\r\n     */\r\n     DesignerSection.prototype.getModuleId = function(element) {\r\n        var id;\r\n        Y.use('moodle-course-util', function(Y) {\r\n            id = Y.Moodle.core_course.util.cm.getId(Y.Node(element.get(0)));\r\n        });\r\n        return id;\r\n    };\r\n\r\n    DesignerSection.prototype.refreshSectionInfo = function(target) {\r\n        var self = this;\r\n        let sectioninfo = target.currentTarget.closest(\"li.section\");\r\n        let sectionId = $(sectioninfo).attr('data-id');\r\n        let sectionReturn = $(sectioninfo).attr('data-sectionreturnid');\r\n        var spinner = self.addSectionSpinner(sectioninfo);\r\n        var args = {\r\n            courseid: self.courseId,\r\n            sectionid: sectionId,\r\n            sectionreturn: sectionReturn\r\n        };\r\n        window.setTimeout(function(args) {\r\n            var promises = Ajax.call([{\r\n                methodname: 'format_designer_section_refresh',\r\n                args: args\r\n            }], true);\r\n            $.when.apply($, promises)\r\n                .done(function(dataencoded) {\r\n                    var data = $.parseJSON(dataencoded);\r\n                    if (data.modules !== undefined) {\r\n                        for (var i in data.modules) {\r\n                            self.replaceActivityhtml(data.modules[i]);\r\n                        }\r\n                    }\r\n                });\r\n\r\n        }, 1000, args);\r\n        self.removeSectionSpinner(sectioninfo, spinner, 400);\r\n    };\r\n\r\n    DesignerSection.prototype.editModuleRenderer = function(event) {\r\n        var self = this;\r\n        if (event.type === 'keypress' && event.keyCode !== 13) {\r\n            return;\r\n        }\r\n        var actionItem = $(event.currentTarget),\r\n        moduleElement = actionItem.closest(SELECTOR.ACTIVITYLI),\r\n        action = actionItem.attr('data-action'),\r\n        moduleId = self.getModuleId(moduleElement);\r\n        switch (action) {\r\n            case 'moveleft':\r\n            case 'moveright':\r\n            case 'delete':\r\n            case 'duplicate':\r\n            case 'hide':\r\n            case 'stealth':\r\n            case 'show':\r\n            case 'groupsseparate':\r\n            case 'groupsvisible':\r\n            case 'groupsnone':\r\n                break;\r\n            default:\r\n                // Nothing to do here!\r\n                return;\r\n        }\r\n        if (!moduleId) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        if (action === 'delete') {\r\n            // Deleting requires confirmation.\r\n            window.setTimeout(function() {\r\n                $('.modal-footer button[data-action=\"save\"]').click(function() {\r\n                    self.refreshSectionInfo(event);\r\n                });\r\n            }, 500);\r\n        } else {\r\n            self.refreshSectionInfo(event);\r\n        }\r\n    };\r\n\r\n    DesignerSection.prototype.fullmodcontentHandler = function(event) {\r\n        var THIS = $(event.currentTarget);\r\n        let fullContent = $(THIS).closest('li.activity').find('.fullcontent-summary');\r\n        let trimcontent = $(THIS).closest('li.activity').find('.trim-summary');\r\n        if (trimcontent.hasClass('summary-hide')) {\r\n            trimcontent.removeClass('summary-hide');\r\n            fullContent.addClass('summary-hide');\r\n        }\r\n    };\r\n\r\n    DesignerSection.prototype.trimmodcontentHandler = function(event) {\r\n        var THIS = $(event.currentTarget);\r\n        let fullContent = $(THIS).closest('li.activity').find('.fullcontent-summary');\r\n        let trimcontent = $(THIS).closest('li.activity').find('.trim-summary');\r\n        if (fullContent.hasClass('summary-hide')) {\r\n            fullContent.removeClass('summary-hide');\r\n            trimcontent.addClass('summary-hide');\r\n        }\r\n    };\r\n\r\n    DesignerSection.prototype.sectionRestrictHandler = function(event) {\r\n        var sectionRestrictInfo = $(event.currentTarget).prev();\r\n        if (sectionRestrictInfo) {\r\n            if (!sectionRestrictInfo.hasClass('show')) {\r\n                sectionRestrictInfo.addClass('show');\r\n            } else {\r\n                sectionRestrictInfo.removeClass('show');\r\n            }\r\n        }\r\n    };\r\n\r\n    DesignerSection.prototype.moduleHandler = function(event) {\r\n        event.preventDefault();\r\n        var restrictBlock = $(event.currentTarget).parents('.restrict-block');\r\n        if (restrictBlock.length) {\r\n            if (!restrictBlock.hasClass('show')) {\r\n                restrictBlock.addClass('show');\r\n            } else {\r\n                restrictBlock.removeClass('show');\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Implementaion swith the section layout.\r\n     * @param {object} event\r\n     */\r\n    DesignerSection.prototype.sectionLayoutaction = function(event) {\r\n        var self = this;\r\n        let sectionId = event.target.closest('li.section').getAttribute('id');\r\n        var iconBlock = \"#\" + sectionId + \" \" + self.loadingElement;\r\n        var layout = $(event.currentTarget).data('value');\r\n        var layouttext = $(event.currentTarget).text();\r\n        $(event.target).parents(\".dropdown\").find(\".btn\").html(layouttext);\r\n        $(event.target).parents(\".dropdown\").find(\".btn\").val(layout);\r\n        $(event.target).parent().find(\"a.dropdown-item\").each(function() {\r\n            $(this).removeClass('active');\r\n        });\r\n        $(event.target).addClass('active');\r\n        let dataid = event.target.closest('li.section').getAttribute('data-id');\r\n        var args = {\r\n            courseid: self.courseId,\r\n            sectionid: dataid,\r\n            options: [{name: $(event.currentTarget).data('option'), value: layout}]\r\n        };\r\n        var ULClasses = {\r\n            'cards': 'card-deck card-layout',\r\n            'list': 'list-layout',\r\n            'default': 'link-layout',\r\n            'circles': 'circles-layout',\r\n            'horizontal_circles': 'circles-layout horizontal-circles-layout'\r\n\r\n        };\r\n        var promises = Ajax.call([{\r\n                methodname: 'format_designer_set_section_options',\r\n                args: args\r\n            }], true);\r\n        $.when.apply($, promises)\r\n            .done(function(dataencoded) {\r\n                var data = $.parseJSON(dataencoded);\r\n                if (data.modules !== undefined) {\r\n                    for (var i in data.modules) {\r\n                        self.replaceActivityhtml(data.modules[i]);\r\n                    }\r\n                    document.getElementById(sectionId).classList.forEach((className) => {\r\n                        if (className.startsWith('section-type-')) {\r\n                            document.getElementById(sectionId).classList.remove(className);\r\n                        }\r\n                    });\r\n                    document.getElementById(sectionId).classList.add('section-type-' + layout);\r\n                    $('#' + sectionId).find('ul.section').removeClass(ULClasses.cards);\r\n                    $('#' + sectionId).find('ul.section').removeClass(ULClasses.list);\r\n                    $('#' + sectionId).find('ul.section').removeClass(ULClasses.default);\r\n                    $('#' + sectionId).find('ul.section').removeClass(ULClasses.circles);\r\n                    $('#' + sectionId).find('ul.section').addClass(ULClasses[layout]);\r\n                }\r\n            });\r\n        Loadingicon.addIconToContainerRemoveOnCompletion(iconBlock, promises);\r\n    };\r\n\r\n    /**\r\n     * Replaces the course module with the new html (used to update module after it was edited or its visibility was changed).\r\n     *\r\n     * @param {String} activityHTML\r\n     */\r\n    DesignerSection.prototype.replaceActivityhtml = function(activityHTML) {\r\n        $('<div>' + activityHTML + '</div>').find(SELECTOR.ACTIVITYLI).each(function() {\r\n            // Extract id from the new activity html.\r\n            var id = $(this).attr('id');\r\n            // Find the existing element with the same id and replace its contents with new html.\r\n            $(SELECTOR.ACTIVITYLI + '#' + id).replaceWith(activityHTML);\r\n            // Initialise action menu.\r\n            initActionMenu(id);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Initialise action menu for the element (section or module)\r\n     *\r\n     * @param {String} elementid CSS id attribute of the element\r\n     */\r\n    var initActionMenu = function(elementid) {\r\n        // Initialise action menu in the new activity.\r\n        Y.use('moodle-course-coursebase', function() {\r\n            M.course.coursebase.invoke_function('setup_for_resource', '#' + elementid);\r\n        });\r\n        if (M.core.actionmenu && M.core.actionmenu.newDOMNode) {\r\n            M.core.actionmenu.newDOMNode(Y.one('#' + elementid));\r\n        }\r\n    };\r\n\r\n    return {\r\n        init: function(courseId, contextId, popupActivities) {\r\n            return new DesignerSection(courseId, contextId, popupActivities);\r\n        }\r\n    };\r\n});"],"file":"designer_section.min.js"}