{"version":3,"file":"designer_section.min.js","sources":["../src/designer_section.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * Implemented designer format js.\n *\n * @module     format_designer/designer_section\n * @copyright  2021 bdecent gmbh <https://bdecent.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n define(['jquery', 'core/fragment', 'core/templates', 'core/loadingicon', 'core/ajax',\n    'core_course/actions', 'core_message/toggle_contact_button', 'theme_boost/popover', 'core/notification',],\n function($, Fragment, Templates, Loadingicon, Ajax, Actions, Contact, Notification) {\n\n    var SELECTOR = {\n        ACTIVITYLI: 'li.activity',\n        SECTIONLI: 'li.section',\n        ACTIVITYACTION: 'a.cm-edit-action',\n        SECTIONACTIONMENU: '.section_action_menu.designer-menu',\n    };\n\n    Y.use('moodle-course-coursebase', function() {\n        var courseformatselector = M.course.format.get_section_selector();\n        if (courseformatselector) {\n            SELECTOR.SECTIONLI = courseformatselector;\n        }\n    });\n\n\n    /**\n     * Control designer format action\n     * @param {int} courseId\n     * @param {int} contextId\n     * @param {array} popupActivities\n     * @param {bool} videoTime\n     * @param {bool} issubpanel\n     * @param {int} sectionreturn\n     */\n    let DesignerSection = function(courseId, contextId, popupActivities, videoTime, issubpanel, sectionreturn) {\n        var self = this;\n        self.courseId = courseId;\n        self.contextId = contextId;\n        self.popupActivities = popupActivities;\n        self.videoTime = videoTime;\n        self.isSubpanel = issubpanel;\n        self.sectionReturn = sectionreturn;\n\n        $(\".course-info-block .carousel .carousel-item:nth-child(1)\").addClass('active');\n        $(\".course-info-block #courseStaffinfoControls.carousel\").addClass('active');\n\n        $('body').delegate(self.SectionController, 'click', self.sectionLayoutaction.bind(this));\n        $('body').delegate(self.SectionSubmenuSwitcher, 'click', self.sectionLayoutaction.bind(this));\n\n        $(\"body\").delegate(self.RestrictInfo, \"click\", self.moduleHandler.bind(this));\n        $(\"body\").delegate(self.sectionRestricted, \"click\", this.sectionRestrictHandler.bind(this));\n        $('body').delegate(self.fullDescription, \"click\", self.fullmodcontentHandler.bind(this));\n        $('body').delegate(self.trimDescription, \"click\", self.trimmodcontentHandler.bind(this));\n        $('body').delegate(self.goToURL, \"click\", self.redirectToModule.bind(this));\n        $('body').delegate(self.goToSectionURL, \"click\", self.redirectToSection.bind(this));\n        window.onhashchange = function() {\n            self.expandSection();\n        };\n        this.expandSection();\n\n        var contactModalHandler = document.getElementsByClassName('toggle-contact-button');\n        Array.from(contactModalHandler).forEach(function(element) {\n            element.addEventListener('click', function(e) {\n                e.preventDefault();\n                if (e.currentTarget.dataset.userid != undefined) {\n                    Contact.enhance(e.currentTarget);\n                }\n            });\n        });\n\n        $('.progress .progress-bar[data-toggle=\"popover\"]').popover();\n\n    };\n\n    /**\n     * Selector section controller.\n     */\n    DesignerSection.prototype.goToURL = '.designer [data-action=\"go-to-url\"]';\n\n    DesignerSection.prototype.goToSectionURL = '.designer [data-action=\"go-to-section-url\"]';\n\n    DesignerSection.prototype.SectionController = \".designer #section-designer-action .dropdown-menu a\";\n\n    DesignerSection.prototype.SectionSubmenuSwitcher\n        = \".designer .section_action_menu .dropdown-subpanel a[data-value=section-designer-action] + .dropdown-menu a\";\n\n    DesignerSection.prototype.RestrictInfo = \".designer .designer-section-content .call-action-block\";\n\n    DesignerSection.prototype.moduleBlock = \".designer .designer-section-content li.activity\";\n\n    DesignerSection.prototype.loadingElement = \".icon-loader-block\";\n\n    DesignerSection.prototype.sectionRestricted = \".designer .availability-section-block .section-restricted-action\";\n\n    DesignerSection.prototype.fullDescription = \".designer-section-content li .fullcontent-summary .mod-description-action\";\n\n    DesignerSection.prototype.trimDescription = \".designer-section-content li .trim-summary .mod-description-action\";\n\n    DesignerSection.prototype.modules = null;\n\n    DesignerSection.prototype.redirectToModule = function(event) {\n        let nodeName = event.target.nodeName;\n        let preventionNodes = ['a', 'button', 'form'];\n        let iscircle = event.target.closest('li.activity').classList.contains('circle-layout');\n        let isDescription = event.target.classList.contains('mod-description-action');\n        let isPadlock = event.target.classList.contains('fa-lock');\n        let ispopupModule = event.target.closest('li.activity').classList.contains('popmodule');\n        let isModHasURL = event.target.closest('li.activity div[data-action=\"go-to-url\"]').getAttribute('data-url');\n        let isCompletionButton = event.target.closest('button[data-action=\"toggle-manual-completion\"]');\n        if ((nodeName in preventionNodes)\n            || document.body.classList.contains('editing') || iscircle || isDescription || isPadlock || ispopupModule\n            || isModHasURL == '' || isCompletionButton) {\n            if (ispopupModule && !document.body.classList.contains('editing')) {\n                if (event.target.closest(\"button[data-action='toggle-manual-completion']\") === null &&\n                    event.target.closest(\".mod-description-action\") === null) {\n                    var li = event.target.closest('li.activity');\n                    li.querySelector('a[href]').click();\n                }\n            }\n            return null;\n        }\n        var card = event.target.closest(\"[data-action=go-to-url]\");\n        let modurl = card.getAttribute('data-url');\n        window.location.href = modurl;\n        return true;\n    };\n\n    DesignerSection.prototype.redirectToSection = function(event) {\n        let isPadlock = event.target.classList.contains('fa-lock');\n        if (document.body.classList.contains('editing') || isPadlock) {\n            return null;\n        }\n        var singlesection = event.target.closest(\"[data-action=go-to-section-url]\");\n        let sectionurl = singlesection.getAttribute('data-url');\n        let sectiontarget =  \"_self\";\n        let target = singlesection.getAttribute('data-target');\n        if (target) {\n            sectiontarget = target;\n        }\n        window.open(sectionurl, sectiontarget);\n        return true;\n    };\n\n    DesignerSection.prototype.expandSection = () => {\n        var sectionID = window.location.hash;\n        if (sectionID) {\n            var id = sectionID.substring(1);\n            var section = document.getElementById(id);\n            if (section) {\n                var title = section.querySelector('.section-header-content');\n                if (title) {\n                    title.classList.remove('collapsed');\n                    title.setAttribute('aria-expanded', true);\n                }\n                var content = section.querySelector('.content');\n                if (content) {\n                    content.classList.add('show');\n                }\n                if (document.getElementById('section-course-accordion') !== null) {\n                    document.getElementById('section-head-0').classList.add('collapsed');\n                    document.getElementById('section-content-0').classList.remove('show');\n                }\n                section.scrollIntoView();\n            }\n        }\n    };\n\n    DesignerSection.prototype.fullmodcontentHandler = function(event) {\n        var THIS = $(event.currentTarget);\n        let fullContent = $(THIS).closest('li.activity').find('.fullcontent-summary');\n        let trimcontent = $(THIS).closest('li.activity').find('.trim-summary');\n        if (trimcontent.hasClass('summary-hide')) {\n            trimcontent.removeClass('summary-hide');\n            fullContent.addClass('summary-hide');\n        }\n    };\n\n    DesignerSection.prototype.trimmodcontentHandler = function(event) {\n        var THIS = $(event.currentTarget);\n        let fullContent = $(THIS).closest('li.activity').find('.fullcontent-summary');\n        let trimcontent = $(THIS).closest('li.activity').find('.trim-summary');\n        if (fullContent.hasClass('summary-hide')) {\n            fullContent.removeClass('summary-hide');\n            trimcontent.addClass('summary-hide');\n        }\n    };\n\n    DesignerSection.prototype.sectionRestrictHandler = function(event) {\n        var sectionRestrictInfo = $(event.currentTarget).prev();\n        if (sectionRestrictInfo) {\n            if (!sectionRestrictInfo.hasClass('show')) {\n                sectionRestrictInfo.addClass('show');\n            } else {\n                sectionRestrictInfo.removeClass('show');\n            }\n        }\n    };\n\n    DesignerSection.prototype.moduleHandler = function(event) {\n        event.preventDefault();\n        var restrictBlock = $(event.currentTarget).parents('.restrict-block');\n        if (restrictBlock.length) {\n            if (!restrictBlock.hasClass('show')) {\n                restrictBlock.addClass('show');\n            } else {\n                restrictBlock.removeClass('show');\n            }\n        }\n    };\n\n    DesignerSection.prototype.updateVideoTimeInstance = function(sectionId) {\n        var section = \"#\" + sectionId;\n        var sectionVideotimes = \"body \"+ section + \" .activity.videotime\";\n        if ($(sectionVideotimes).length == 0) {\n            return;\n        }\n        $(sectionVideotimes).each(function(index, module) {\n            this.CreateInstance(module);\n        }.bind(this));\n    };\n\n    DesignerSection.prototype.CreateInstance = function (module) {\n        if (\n            $(module).find('.instancename').length\n            && ($(module).find('.vimeo-embed').length\n            || $(module).find('.video-js').length)\n        ) {\n            var cmId = module.getAttribute(\"data-id\");\n            var args = {cmid : cmId};\n            // Get module instance.\n            var promises = Ajax.call([{\n                methodname: 'format_designer_get_videotime_instace',\n                args: args\n            }], true);\n            promises[0].then(function(data) {\n                var template = JSON.parse(data);\n                if (template.playertype == 'videojs') {\n                    var uniqueid =  $(module).find('.video-js').first().attr('id').replace('vimeo-embed-', '');\n                } else {\n                    var uniqueid =  $(module).find('.vimeo-embed').first().attr('id').replace('vimeo-embed-', '');\n                }\n                template.uniqueid = uniqueid;\n                Templates.render(template.templatename, template).then(function(html, js) {\n                    Templates.runTemplateJS(js);\n                    return true;\n                }).fail(Notification.exception);\n            });\n        }\n    };\n\n    /**\n     * Implementaion swith the section layout.\n     * @param {object} event\n     */\n    DesignerSection.prototype.sectionLayoutaction = function(event) {\n        event.preventDefault();\n        var self = this;\n        let sectionId = event.target.closest('li.section').getAttribute('id');\n        var sectionid = event.target.closest('li.section').getAttribute('data-id');\n        var sectionitem = document.getElementById(sectionId);\n        var iconBlock = \"#\" + sectionId + \" \" + self.loadingElement;\n        var layout = $(event.currentTarget).data('value');\n        var layouttext = $(event.currentTarget).text();\n        $(event.target).parents(\".dropdown\").find(\".btn\").html(layouttext);\n        $(event.target).parents(\".dropdown\").find(\".btn\").val(layout);\n        $(event.target).parent().find(\"a.dropdown-item\").each(function() {\n            $(this).removeClass('active');\n        });\n        $(event.target).addClass('active');\n        let dataid = event.target.closest('li.section').getAttribute('data-id');\n        var args = {\n            courseid: self.courseId,\n            sectionid: dataid,\n            options: [{name: $(event.currentTarget).data('option'), value: layout}]\n        };\n        var promises = Ajax.call([{\n                methodname: 'format_designer_set_section_options',\n                args: args\n            }], true);\n            $.when.apply($, promises)\n            .done(function() {\n                if (self.isSubpanel) {\n                    const promise = Fragment.loadFragment(\n                        'core_courseformat',\n                        'section',\n                        self.contextId,\n                        {\n                            id: sectionid,\n                            courseid: self.courseId,\n                            sr: self.sectionReturn,\n                        }\n                    );\n                    promise.then((html, js) => {\n                        Templates.replaceNode(sectionitem, html, js);\n                    }).catch();\n                } else {\n                    const sectionpromise = Actions.refreshSection('#' + sectionId, dataid, 0);\n                    sectionpromise.then(() => {\n                        return '';\n                    }).catch();\n                }\n            });\n        Loadingicon.addIconToContainerRemoveOnCompletion(iconBlock, promises);\n        // If videotime exist update the module.\n        setTimeout(function() {\n            if (self.videoTime) {\n                self.updateVideoTimeInstance(sectionId);\n            }\n        }, 2000);\n    };\n\n    return {\n        init: function(courseId, contextId, popupActivities, videoTime, issubpanel, sectionreturn) {\n            return new DesignerSection(courseId, contextId, popupActivities, videoTime, issubpanel, sectionreturn);\n        }\n    };\n});\n"],"names":["define","$","Fragment","Templates","Loadingicon","Ajax","Actions","Contact","Notification","SELECTOR","ACTIVITYLI","SECTIONLI","ACTIVITYACTION","SECTIONACTIONMENU","Y","use","courseformatselector","M","course","format","get_section_selector","DesignerSection","courseId","contextId","popupActivities","videoTime","issubpanel","sectionreturn","self","this","isSubpanel","sectionReturn","addClass","delegate","SectionController","sectionLayoutaction","bind","SectionSubmenuSwitcher","RestrictInfo","moduleHandler","sectionRestricted","sectionRestrictHandler","fullDescription","fullmodcontentHandler","trimDescription","trimmodcontentHandler","goToURL","redirectToModule","goToSectionURL","redirectToSection","window","onhashchange","expandSection","contactModalHandler","document","getElementsByClassName","Array","from","forEach","element","addEventListener","e","preventDefault","undefined","currentTarget","dataset","userid","enhance","popover","prototype","moduleBlock","loadingElement","modules","event","nodeName","target","iscircle","closest","classList","contains","isDescription","isPadlock","ispopupModule","isModHasURL","getAttribute","isCompletionButton","body","querySelector","click","modurl","location","href","singlesection","sectionurl","sectiontarget","open","sectionID","hash","id","substring","section","getElementById","title","remove","setAttribute","content","add","scrollIntoView","THIS","fullContent","find","trimcontent","hasClass","removeClass","sectionRestrictInfo","prev","restrictBlock","parents","length","updateVideoTimeInstance","sectionId","sectionVideotimes","each","index","module","CreateInstance","args","cmid","call","methodname","then","data","template","JSON","parse","playertype","uniqueid","first","attr","replace","render","templatename","html","js","runTemplateJS","fail","exception","sectionid","sectionitem","iconBlock","layout","layouttext","text","val","parent","dataid","courseid","options","name","value","promises","when","apply","done","loadFragment","sr","replaceNode","catch","refreshSection","addIconToContainerRemoveOnCompletion","setTimeout","init"],"mappings":"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"}